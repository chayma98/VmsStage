Public Sub MoveData_FromLect2Output()
alertOFF
    Dim wF As WorksheetFunction: Set wF = Application.WorksheetFunction
    Dim Lecture As Worksheet: Set Lecture = Lect
    Lect.Activate
    Dim L As Long: L = Range("A1").EntireColumn.Rows.count
    Dim iOutput As Worksheet: Set iOutput = MainSht
    Dim iDetail As Worksheet: Set iDetail = Detail
    Dim LookingHead As Range: Set LookingHead = Detail.Range("iHead")
    Dim oHead As Long: oHead = wF.Match(LookingHead.Value, Range("A1", Cells(1, Range("A1").SpecialCells(xlCellTypeLastCell).Column)), False)
    
    Dim R
    Dim C
    Dim Def As Long: Def = 1 'This is the column with the names in Lecture
    
    Dim iLenXYZ As Long: iLenXYZ = Range("B1").Column
    Dim iniCell As Long: iniCell = 2
    Dim endCell As Long: endCell = Range("A1").SpecialCells(xlCellTypeLastCell).Row
    Dim iRNG As Range
    Dim jRNG As Range
    Dim DefCol As Range: Set DefCol = Range(Cells(iniCell, Def), Cells(endCell, Def))
    Dim iLen As String
    
    R = Range("A1").SpecialCells(xlCellTypeLastCell).Row
    C = Range("A1").Column
    
    Dim i As Range
    Dim j As Range
    Dim k As Range
    Dim DetRng As Range
    Dim rng4Level As Range
    
    For Each i In DefCol
        Lect.Activate
        iLen = Range(Cells(i.Row, oHead), Cells(i.Row, oHead)).Value
        iDetail.Activate
        Set DetRng = iDetail.Range(Cells(1, 2), Cells(Range("A1").SpecialCells(xlCellTypeLastCell).Row, 2))
        For Each j In DetRng
            If j.Value = "" Then
                'do noting
            Else
                If i.Value = j.Value Then
                    If j.Offset(1, 3).Value = "" Then
                        'do nothing
                    Else
                        Set k = j.Offset(1, 3)
                        Set rng4Level = Nothing
                        If k.Offset(1, 0).Value = "" Then
                            Set rng4Level = k
                            Exit For
                        Else
                            Set rng4Level = Range(k, k.End(xlDown))
                            Exit For
                        End If
                    End If
                End If
            End If
        Next j
        iOutput.Activate
        
        Dim LastRowOut As Long: LastRowOut = Range(Cells(L, 7), Cells(L, 7)).End(xlUp).Row + 1
        Range(Cells(LastRowOut, 4), Cells(LastRowOut, 4)).Value = i.Value
        Range(Cells(LastRowOut, 5), Cells(LastRowOut, 5)).Value = iLen
        
        If rng4Level Is Nothing Then
            Range(Cells(LastRowOut, 7), Cells(LastRowOut, 7)).Value = "EMPTY"
        Else
            R = rng4Level.Rows.count
            Range(Cells(LastRowOut + 1, 7), Cells(LastRowOut + R, 7)).Value = rng4Level.Value
            Set rng4Level = Nothing
        End If
    Next i
alertON
End Sub
